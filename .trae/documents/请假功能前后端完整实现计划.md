我将为您完成请假功能的前后端开发，实现从页面上传附件、提交申请到后端自动匹配审批人并落库的全流程。

### 1. 后端开发 (新建文件，不影响现有逻辑)
我们将基于新设计的数据库表实现一套全新的请假业务逻辑。

*   **创建实体类 (Entity)**: 对应新表结构
    *   `LeaveRequests`: 请假主表
    *   `LeaveRequestAttachments`: 附件表
    *   `LeaveRequestAuditLogs`: 操作日志表
    *   `LeaveApproverRules`: 审批规则表
    *   `DepartmentCounselors`: 辅导员配置表
    *   `UserClassRel`: 学生-班级关系表
    *   `Classes`: 班级表
*   **创建数据访问层 (Mapper)**:
    *   为上述实体创建 Mapper 接口，用于数据库操作。
*   **创建传输对象 (DTO)**:
    *   `LeaveSubmitReq`: 接收前端提交的请假信息（含附件列表）。
    *   `AttachmentItem`: 附件详情（URL、文件名、大小等）。
*   **创建控制器 (Controller)**:
    *   `LeaveController`: 提供 `/capi/leave/submit` 接口。
*   **创建服务层 (Service)**:
    *   `LeaveService`: 实现核心逻辑：
        1.  计算请假时长。
        2.  根据 `LeaveApproverRules` 和时长自动判断审批人类型（班主任/辅导员）。
        3.  根据类型查询 `Classes` 或 `DepartmentCounselors` 找到具体审批人 UID。
        4.  开启事务，同时保存主表、附件表和初始日志。

### 2. 前端开发 (修改 `src/pages/workbench/leave/index.vue`)
*   **对接文件上传**:
    *   实现 `handleUploadImage`: 调用 `uni.chooseImage` 选择图片，上传到 `/file/upload`，保存返回的 URL。
    *   实现 `handleUploadFile`: 调用 `uni.chooseMessageFile` (小程序) 或 `uni.chooseFile` (H5) 选择文件，上传到 `/file/upload`。
    *   维护 `fileList` 数组，展示已上传的附件，支持删除。
*   **对接提交接口**:
    *   实现 `submit` 方法：收集表单数据（类型、时间、原因、附件），发送 POST 请求到 `/capi/leave/submit`。
    *   提交成功后清空表单并返回。

### 3. 验证
*   前端模拟提交请假申请（含图片/文件）。
*   检查后端数据库，确认 `leave_requests` 表中审批人 (`approver_id`) 是否根据天数规则正确自动生成。

**注意**: 后端已有 `/file/upload` 接口，我们将直接复用该接口进行附件上传。
